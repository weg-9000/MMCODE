# MMCODE Masscan Security Configuration
# ====================================
#
# Secure Masscan configuration for sandbox environment
# Enforces scan rate limits and security policies

# Rate limiting (packets per second)
# Conservative rate to avoid overwhelming targets
rate = 1000

# Port configuration
# Default port ranges for common services
ports = 21,22,23,25,53,80,110,135,139,143,443,993,995,1433,3306,3389,5432,8080,8443

# Network interface configuration
# Use specific adapter (will be auto-detected if not specified)
# adapter-ip = 192.168.1.100
# adapter-port = 60000

# Output configuration
output-format = binary
output-filename = /tmp/scan-results/masscan-results.bin

# Additional output formats
output-format = xml
output-filename = /tmp/scan-results/masscan-results.xml

# Timing configuration
retries = 2
wait = 10

# Banner grabbing (disabled for security)
banners = false

# Source IP randomization (disabled for traceability)
randomize-hosts = false

# Packet configuration
# Use SYN scan for speed and stealth
conf-file = /etc/masscan/masscan.conf

# Exclude certain ports known to be sensitive
exclude-ports = 135,139,445,1433,3389,5432,1521

# Connection limits
max-rate = 10000
connection-timeout = 5

# Network configuration
# Ensure we bind to the correct interface
source-port = 61000
ttl = 255

# Logging configuration
append-output = false
output-append = false

# Advanced options
ping = true
http-user-agent = "MMCODE-Scanner/1.0"

# Exclude private administration ports
excludefile = /etc/mmcode-sandbox/masscan/exclude-ports.txt

# Packet capture settings (disabled for security)
pcap = false
packet-trace = false
pfring = false

# Exit criteria
exit-code = 0