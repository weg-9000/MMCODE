# MMCODE Security Sandbox Resource Limits
# =======================================
#
# Resource limits for sandbox user to prevent resource exhaustion
# and ensure system stability during security tool execution

# User/Group limits for sandbox user
mmcode-runner soft nproc 100
mmcode-runner hard nproc 150
mmcode-runner soft nofile 1024
mmcode-runner hard nofile 2048

# Memory limits (in KB)
mmcode-runner soft as 2097152    # 2GB virtual memory
mmcode-runner hard as 2621440    # 2.5GB virtual memory
mmcode-runner soft data 1048576  # 1GB data segment
mmcode-runner hard data 1572864  # 1.5GB data segment

# CPU limits (in seconds)
mmcode-runner soft cpu 3600      # 1 hour CPU time
mmcode-runner hard cpu 7200      # 2 hours CPU time (hard limit)

# Core dump limits
mmcode-runner soft core 0        # No core dumps
mmcode-runner hard core 0        # No core dumps

# File size limits
mmcode-runner soft fsize 524288  # 512MB file size
mmcode-runner hard fsize 1048576 # 1GB file size

# Stack size limits
mmcode-runner soft stack 8192    # 8MB stack
mmcode-runner hard stack 16384   # 16MB stack

# Process priority limits
mmcode-runner soft priority 10
mmcode-runner hard priority 20

# Lock limits
mmcode-runner soft locks 16
mmcode-runner hard locks 32

# Real-time priority (disabled for security)
mmcode-runner soft rtprio 0
mmcode-runner hard rtprio 0

# Nice priority limits
mmcode-runner soft nice 5
mmcode-runner hard nice 10

# Message queue limits
mmcode-runner soft msgqueue 819200  # 800KB
mmcode-runner hard msgqueue 1638400 # 1.6MB